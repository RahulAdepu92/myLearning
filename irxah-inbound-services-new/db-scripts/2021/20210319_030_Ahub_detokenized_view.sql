-- create VW_ACCUMULATOR_DETAIL_DETOKENIZED in PROD env

CREATE OR REPLACE VIEW AHUB_DW.VW_ACCUMULATOR_DETAIL_DETOKENIZED AS (
SELECT
 DETAIL.JOB_KEY
,DETAIL.LINE_NUMBER
,DETAIL.ACCUMULATOR_DETAIL_KEY
,DETAIL.PROCESSOR_ROUTING_IDENTIFICATION
,DETAIL.RECORD_TYPE
,DETAIL.TRANSMISSION_FILE_TYPE
,DETAIL.VERSION_RELEASE_NUMBER
,DETAIL.SENDER_IDENTIFIER
,DETAIL.RECEIVER_IDENTIFIER
,DETAIL.SUBMISSION_NUMBER
,DETAIL.TRANSACTION_RESPONSE_STATUS
,DETAIL.REJECT_CODE
,DETAIL.RECORD_LENGTH
,DETAIL.RESERVED_1
,DETAIL.TRANSMISSION_DATE
,DETAIL.TRANSMISSION_TIME
,DETAIL.DATE_OF_SERVICE
,DETAIL.SERVICE_PROVIDER_IDENTIFIER_QUALIFIER
,DETAIL.SERVICE_PROVIDER_IDENTIFIER
,DETAIL.DOCUMENT_REFERENCE_IDENTIFIER_QUALIFIER
,DETAIL.DOCUMENT_REFERENCE_IDENTIFIER
,DETAIL.TRANSMISSION_IDENTIFIER
,DETAIL.BENEFIT_TYPE
,DETAIL.IN_NETWORK_INDICATOR
,DETAIL.FORMULARY_STATUS
,DETAIL.ACCUMULATOR_ACTION_CODE
,DETAIL.SENDER_REFERENCE_NUMBER
,DETAIL.INSURANCE_CODE
,DETAIL.ACCUMULATOR_BALANCE_BENEFIT_TYPE
,DETAIL.BENEFIT_EFFECTIVE_DATE
,DETAIL.BENEFIT_TERMINATION_DATE
,DETAIL.ACCUMULATOR_CHANGE_SOURCE_CODE
,DETAIL.TRANSACTION_IDENTIFIER
,DETAIL.TRANSACTION_IDENTIFIER_CROSS_REFERENCE
,DETAIL.ADJUSTMENT_REASON_CODE
,DETAIL.ACCUMULATOR_REFERENCE_TIME_STAMP
,DETAIL.RESERVED_2
,DETAIL.CARDHOLDER_IDENTIFIER
,concat(concat('~`I', trim(DETAIL.CARDHOLDER_IDENTIFIER)), 'I`~')  CARDHOLDER_IDENTIFIER_PHI
,DETAIL.GROUP_IDENTIFIER
,DETAIL.PATIENT_FIRST_NAME
,concat(concat('~`N', trim(DETAIL.PATIENT_FIRST_NAME)), 'N`~') PATIENT_FIRST_NAME_PHI
,DETAIL.MIDDLE_INITIAL
,concat(concat('~`N', trim(DETAIL.MIDDLE_INITIAL)), 'N`~')  MIDDLE_INITIAL_PHI
,DETAIL.PATIENT_LAST_NAME
,concat(concat('~`N', trim(DETAIL.PATIENT_LAST_NAME)), 'N`~') PATIENT_LAST_NAME_PHI
,DETAIL.PATIENT_RELATIONSHIP_CODE
,DETAIL.DATE_OF_BIRTH
,concat(concat('~`D', trim(DETAIL.DATE_OF_BIRTH)), 'D`~') DATE_OF_BIRTH_PHI
,DETAIL.PATIENT_GENDER_CODE
,DETAIL.PATIENT_STATE_PROVINCE_ADDRESS
,DETAIL.CARDHOLDER_LAST_NAME
,concat(concat('~`N', trim(DETAIL.CARDHOLDER_LAST_NAME)), 'N`~') CARDHOLDER_LAST_NAME_PHI
,DETAIL.CARRIER_NUMBER
,DETAIL.CONTRACT_NUMBER
,DETAIL.CLIENT_PASS_THROUGH
,DETAIL.FAMILY_IDENTIFIER_NUMBER
,concat(concat('~`I', trim(DETAIL.FAMILY_IDENTIFIER_NUMBER)), 'I`~')  FAMILY_IDENTIFIER_NUMBER_PHI
,DETAIL.CARDHOLDER_IDENTIFIER_ALTERNATE
,concat(concat('~`I', trim(DETAIL.CARDHOLDER_IDENTIFIER_ALTERNATE)), 'I`~')  CARDHOLDER_IDENTIFIER_ALTERNATE_PHI
,DETAIL.GROUP_IDENTIFIER_ALTERNATE
,DETAIL.PATIENT_IDENTIFIER
,concat(concat('~`I', trim(DETAIL.PATIENT_IDENTIFIER)), 'I`~')  PATIENT_IDENTIFIER_PHI
,DETAIL.PERSON_CODE
,DETAIL.RESERVED_3
,DETAIL.ACCUMULATOR_BALANCE_COUNT
,DETAIL.ACCUMULATOR_SPECIFIC_CATEGORY_TYPE
,DETAIL.RESERVED_4
,DETAIL.ACCUMULATOR_1_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_1_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_1_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_1_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_1_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_1_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_1_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_1_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_2_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_2_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_2_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_2_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_2_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_2_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_2_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_2_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_3_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_3_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_3_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_3_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_3_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_3_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_3_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_3_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_4_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_4_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_4_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_4_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_4_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_4_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_4_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_4_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_5_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_5_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_5_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_5_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_5_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_5_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_5_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_5_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_6_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_6_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_6_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_6_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_6_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_6_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_6_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_6_REMAINING_BALANCE_ACTION_CODE
,DETAIL.RESERVED_5
,DETAIL.ACCUMULATOR_7_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_7_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_7_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_7_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_7_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_7_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_7_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_7_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_8_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_8_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_8_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_8_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_8_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_8_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_8_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_8_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_9_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_9_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_9_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_9_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_9_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_9_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_9_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_9_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_10_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_10_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_10_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_10_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_10_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_10_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_10_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_10_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_11_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_11_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_11_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_11_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_11_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_11_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_11_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_11_REMAINING_BALANCE_ACTION_CODE
,DETAIL.ACCUMULATOR_12_BALANCE_QUALIFIER
,DETAIL.ACCUMULATOR_12_NETWORK_INDICATOR
,DETAIL.ACCUMULATOR_12_APPLIED_AMOUNT
,DETAIL.ACCUMULATOR_12_APPLIED_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_12_BENEFIT_PERIOD_AMOUNT
,DETAIL.ACCUMULATOR_12_BENEFIT_PERIOD_AMOUNT_ACTION_CODE
,DETAIL.ACCUMULATOR_12_REMAINING_BALANCE
,DETAIL.ACCUMULATOR_12_REMAINING_BALANCE_ACTION_CODE
,DETAIL.OPTIONAL_DATA_INDICATOR
,DETAIL.TOTAL_AMOUNT_PAID
,DETAIL.TOTAL_AMOUNT_PAID_ACTION_CODE
,DETAIL.AMOUNT_OF_COPAY
,DETAIL.AMOUNT_OF_COPAY_ACTION_CODE
,DETAIL.PATIENT_PAY_AMOUNT
,DETAIL.PATIENT_PAY_AMOUNT_ACTION_CODE
,DETAIL.AMOUNT_ATTRIBUTED_TO_PRODUCT_SELECTION_BRAND
,DETAIL.AMOUNT_ATTRIBUTED_TO_PRODUCT_SELECTION_BRAND_ACTION_CODE
,DETAIL.AMOUNT_ATTRIBUTED_TO_SALES_TAX
,DETAIL.AMOUNT_ATTRIBUTED_TO_SALES_TAX_ACTION_CODE
,DETAIL.AMOUNT_ATTRIBUTED_TO_PROCESSOR_FEE
,DETAIL.AMOUNT_ATTRIBUTED_TO_PROCESSOR_FEE_ACTION_CODE
,DETAIL.GROSS_AMOUNT_DUE
,DETAIL.GROSS_AMOUNT_DUE_ACTION_CODE
,DETAIL.INVOICED_AMOUNT
,DETAIL.INVOICED_AMOUNT_ACTION_CODE
,DETAIL.PENALTY_AMOUNT
,DETAIL.PENALTY_AMOUNT_ACTION_CODE
,DETAIL.RESERVED_6
,DETAIL.PRODUCT_SERVICE_IDENTIFIER_QUALIFIER
,DETAIL.PRODUCT_SERVICE_IDENTIFIER
,DETAIL.DAYS_SUPPLY
,DETAIL.QUANTITY_DISPENSED
,DETAIL.PRODUCT_SERVICE_NAME
,DETAIL.BRAND_GENERIC_INDICATOR
,DETAIL.THERAPEUTIC_CLASS_CODE_QUALIFIER
,DETAIL.THERAPEUTIC_CLASS_CODE
,DETAIL.DISPENSED_AS_WRITTEN
,DETAIL.RESERVED_7
,JOB.FILE_NAME
,JOB.CREATED_TIMESTAMP AS FILE_LOADED_TIMESTAMP
,CLIENT.abbreviated_name AS CLIENT_NAME
FROM AHUB_DW.ACCUMULATOR_DETAIL AS DETAIL
LEFT JOIN AHUB_DW.JOB AS JOB
  ON DETAIL.JOB_KEY = JOB.JOB_KEY
LEFT JOIN AHUB_DW.CLIENT
  ON JOB.CLIENT_ID = CLIENT.CLIENT_ID
);
